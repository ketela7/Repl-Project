{"version":3,"names":["cov_18h0jcl2tr","actualCoverage","s","POST","request","f","authResult","_apiutils","initDriveService","success","b","response","driveService","body","json","fileId","targetFolderId","items","_server","NextResponse","error","status","fileIds","length","map","item","id","isBulkOperation","results","errors","result","moveFile","push","message","processed","failed","type","operation","undefined","handleApiError"],"sources":["/home/runner/workspace/src/app/api/drive/files/move/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server'\n\nimport { initDriveService, handleApiError } from '@/lib/api-utils'\n\nexport async function POST(request: NextRequest) {\n  try {\n    const authResult = await initDriveService()\n    if (!authResult.success) {\n      return authResult.response!\n    }\n\n    const driveService = authResult.driveService!\n    const body = await request.json()\n\n    // Handle both single and bulk operations\n    const { fileId, targetFolderId, items } = body\n\n    if (!targetFolderId) {\n      return NextResponse.json({ error: 'Target folder ID is required' }, { status: 400 })\n    }\n\n    // Determine operation type based on items array or single fileId\n    const fileIds = items && items.length > 0 ? items.map((item: any) => item.id) : [fileId]\n    const isBulkOperation = items && items.length > 1\n\n    if (!fileIds || fileIds.length === 0) {\n      return NextResponse.json({ error: 'File IDs are required' }, { status: 400 })\n    }\n\n    const results = []\n    const errors = []\n\n    for (const id of fileIds) {\n      try {\n        const result = await driveService.moveFile(id, targetFolderId)\n        results.push({ fileId: id, success: true, result })\n      } catch (error: any) {\n        errors.push({\n          fileId: id,\n          success: false,\n          error: error.message || 'Move failed',\n        })\n      }\n    }\n\n    const response = {\n      success: errors.length === 0,\n      processed: results.length,\n      failed: errors.length,\n      type: isBulkOperation ? 'bulk' : 'single',\n      operation: 'move',\n      targetFolderId,\n      results,\n      errors: errors.length > 0 ? errors : undefined,\n    }\n\n    return NextResponse.json(response, {\n      status: errors.length === 0 ? 200 : 207,\n    })\n  } catch (error: any) {\n    return handleApiError(error)\n  }\n}\n"],"mappings":"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","ignoreList":[]}
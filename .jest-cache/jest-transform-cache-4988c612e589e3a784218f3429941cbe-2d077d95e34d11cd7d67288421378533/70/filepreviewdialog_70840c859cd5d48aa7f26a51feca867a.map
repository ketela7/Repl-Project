{"version":3,"names":["cov_1vua3l27mj","actualCoverage","s","FilePreviewDialog","f","default","_default","open","onOpenChange","file","isFullscreen","setIsFullscreen","_react","useState","useEffect","handleKeyDown","event","b","key","preventDefault","document","addEventListener","body","style","overflow","removeEventListener","previewUrl","_utils","getPreviewUrl","id","renderPreviewContent","_jsxruntime","jsx","className","src","title","name","allow","allowFullScreen","sandbox","loading","border","outline","jsxs","_button","Button","variant","size","onClick","_lucidereact","Minimize2","X","_dialog","Dialog","DialogContent","DialogHeader","Maximize2","DialogTitle"],"sources":["/home/runner/workspace/src/app/(main)/dashboard/drive/_components/file-preview-dialog.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useEffect } from 'react'\nimport { X, Maximize2, Minimize2 } from 'lucide-react'\n\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog'\nimport { Button } from '@/components/ui/button'\nimport { DriveFile } from '@/lib/google-drive/types'\nimport { getPreviewUrl } from '@/lib/google-drive/utils'\n\ninterface FilePreviewDialogProps {\n  open: boolean\n  onOpenChange: (open: boolean) => void\n  file: DriveFile | null\n}\n\nexport function FilePreviewDialog({ open, onOpenChange, file }: FilePreviewDialogProps) {\n  const [isFullscreen, setIsFullscreen] = useState(false)\n\n  // Handle escape key to exit fullscreen\n  useEffect(() => {\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (event.key === 'Escape' && isFullscreen) {\n        setIsFullscreen(false)\n        event.preventDefault()\n      }\n    }\n\n    if (isFullscreen) {\n      document.addEventListener('keydown', handleKeyDown)\n      document.body.style.overflow = 'hidden'\n    } else {\n      document.body.style.overflow = 'unset'\n    }\n\n    return () => {\n      document.removeEventListener('keydown', handleKeyDown)\n      document.body.style.overflow = 'unset'\n    }\n  }, [isFullscreen])\n\n  // Reset fullscreen when dialog closes\n  useEffect(() => {\n    if (!open) {\n      setIsFullscreen(false)\n    }\n  }, [open])\n\n  if (!file) return null\n\n  const previewUrl = getPreviewUrl(file.id)\n\n  const renderPreviewContent = () => {\n    // Optimized iframe sizing that matches container perfectly\n    if (isFullscreen) {\n      return (\n        <div className=\"absolute inset-0 bg-white\">\n          <iframe\n            src={previewUrl}\n            className=\"h-full w-full\"\n            title={`Preview: ${file.name}`}\n            allow=\"autoplay; encrypted-media; fullscreen\"\n            allowFullScreen\n            sandbox=\"allow-scripts allow-same-origin allow-popups allow-forms allow-presentation\"\n            loading=\"lazy\"\n            style={{\n              border: 'none',\n              outline: 'none',\n            }}\n          />\n        </div>\n      )\n    }\n\n    // Normal dialog view with perfect edge spacing\n    return (\n      <div className=\"h-[75vh] max-h-[80vh] min-h-[400px] w-full overflow-hidden rounded-lg border bg-white\">\n        <iframe\n          src={previewUrl}\n          className=\"h-full w-full\"\n          title={`Preview: ${file.name}`}\n          allow=\"autoplay; encrypted-media; fullscreen\"\n          allowFullScreen\n          sandbox=\"allow-scripts allow-same-origin allow-popups allow-forms allow-presentation\"\n          loading=\"lazy\"\n          style={{\n            border: 'none',\n            outline: 'none',\n          }}\n        />\n      </div>\n    )\n  }\n\n  // Render fullscreen overlay - clean minimal design\n  if (isFullscreen) {\n    return (\n      <div className=\"fixed inset-0 z-[100] bg-black\">\n        {/* Minimal floating controls - moved to top-left */}\n        <div className=\"absolute top-4 left-4 z-10 flex items-center gap-2\">\n          <Button\n            variant=\"ghost\"\n            size=\"sm\"\n            onClick={() => setIsFullscreen(false)}\n            className=\"h-10 w-10 rounded-full bg-black/50 p-0 text-white backdrop-blur-sm hover:bg-white/20\"\n          >\n            <Minimize2 className=\"h-5 w-5\" />\n          </Button>\n          <Button\n            variant=\"ghost\"\n            size=\"sm\"\n            onClick={() => onOpenChange(false)}\n            className=\"h-10 w-10 rounded-full bg-black/50 p-0 text-white backdrop-blur-sm hover:bg-white/20\"\n          >\n            <X className=\"h-5 w-5\" />\n          </Button>\n        </div>\n\n        {/* Fullscreen content */}\n        {renderPreviewContent()}\n      </div>\n    )\n  }\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"h-auto max-h-[95vh] w-[95vw] max-w-6xl overflow-hidden p-4 md:p-6\">\n        {/* Minimal header with clean controls - moved to top-left */}\n        <DialogHeader className=\"pb-3\">\n          <div className=\"flex items-center justify-between gap-4\">\n            <div className=\"flex items-center gap-2\">\n              {/* Fullscreen toggle - moved to left */}\n              <Button variant=\"outline\" size=\"sm\" onClick={() => setIsFullscreen(true)}>\n                <Maximize2 className=\"h-4 w-4\" />\n              </Button>\n            </div>\n            <DialogTitle className=\"flex-1 truncate text-center text-base font-medium md:text-lg\">\n              {file.name}\n            </DialogTitle>\n            <div className=\"w-8\"></div> {/* Spacer for balance */}\n          </div>\n        </DialogHeader>\n\n        {/* Clean preview content with perfect container spacing */}\n        <div className=\"flex-1 overflow-hidden\">{renderPreviewContent()}</div>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nexport default FilePreviewDialog\n"],"mappings":"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","ignoreList":[]}
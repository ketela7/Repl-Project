{"version":3,"sources":["/home/runner/workspace/src/components/auth/__tests__/auth-wrapper.test.tsx"],"sourcesContent":["import { screen } from '@testing-library/react'\nimport { useSession } from 'next-auth/react'\n\nimport { AuthWrapper } from '../auth-wrapper'\nimport { render } from '@testing-library/react'\n\njest.mock('next-auth/react')\nconst mockUseSession = useSession as jest.MockedFunction<typeof useSession>\n\ndescribe('AuthWrapper', () => {\n  const TestComponent = () => <div>Protected Content</div>\n  const FallbackComponent = () => <div>Please sign in</div>\n\n  beforeEach(() => {\n    jest.clearAllMocks()\n  })\n\n  it('shows loading state when session is loading', () => {\n    mockUseSession.mockReturnValue({\n      data: null,\n      status: 'loading',\n      update: jest.fn(),\n    })\n\n    render(\n      <AuthWrapper fallback={<FallbackComponent />}>\n        <TestComponent />\n      </AuthWrapper>\n    )\n\n    expect(screen.getByText('Authenticating')).toBeInTheDocument()\n    expect(screen.getByText('Verifying your Google Drive access...')).toBeInTheDocument()\n    expect(screen.queryByText('Protected Content')).not.toBeInTheDocument()\n    expect(screen.queryByText('Please sign in')).not.toBeInTheDocument()\n  })\n\n  it('shows fallback when user is not authenticated', () => {\n    mockUseSession.mockReturnValue({\n      data: null,\n      status: 'unauthenticated',\n      update: jest.fn(),\n    })\n\n    render(\n      <AuthWrapper fallback={<FallbackComponent />}>\n        <TestComponent />\n      </AuthWrapper>\n    )\n\n    expect(screen.getByText('Please sign in')).toBeInTheDocument()\n    expect(screen.queryByText('Protected Content')).not.toBeInTheDocument()\n    expect(screen.queryByText('Loading...')).not.toBeInTheDocument()\n  })\n\n  it('shows children when user is authenticated', () => {\n    mockUseSession.mockReturnValue({\n      data: {\n        user: { id: 'test-id', name: 'Test User', email: 'test@example.com' },\n        expires: '2025-12-31',\n      },\n      status: 'authenticated',\n      update: jest.fn(),\n    })\n\n    render(\n      <AuthWrapper fallback={<FallbackComponent />}>\n        <TestComponent />\n      </AuthWrapper>\n    )\n\n    expect(screen.getByText('Protected Content')).toBeInTheDocument()\n    expect(screen.queryByText('Please sign in')).not.toBeInTheDocument()\n    expect(screen.queryByText('Loading...')).not.toBeInTheDocument()\n  })\n\n  it('shows default fallback when no custom fallback provided', () => {\n    mockUseSession.mockReturnValue({\n      data: null,\n      status: 'unauthenticated',\n      update: jest.fn(),\n    })\n\n    render(\n      <AuthWrapper>\n        <TestComponent />\n      </AuthWrapper>\n    )\n\n    expect(screen.getByText('Access denied. Please sign in.')).toBeInTheDocument()\n    expect(screen.queryByText('Protected Content')).not.toBeInTheDocument()\n  })\n})\n"],"names":["jest","mock","mockUseSession","useSession","describe","TestComponent","div","FallbackComponent","beforeEach","clearAllMocks","it","mockReturnValue","data","status","update","fn","render","AuthWrapper","fallback","expect","screen","getByText","toBeInTheDocument","queryByText","not","user","id","name","email","expires"],"mappings":";AAMAA,KAAKC,IAAI,CAAC;;;;;uBANa;wBACI;6BAEC;AAI5B,MAAMC,iBAAiBC,kBAAU;AAEjCC,SAAS,eAAe;IACtB,MAAMC,gBAAgB,kBAAM,qBAACC;sBAAI;;IACjC,MAAMC,oBAAoB,kBAAM,qBAACD;sBAAI;;IAErCE,WAAW;QACTR,KAAKS,aAAa;IACpB;IAEAC,GAAG,+CAA+C;QAChDR,eAAeS,eAAe,CAAC;YAC7BC,MAAM;YACNC,QAAQ;YACRC,QAAQd,KAAKe,EAAE;QACjB;QAEAC,IAAAA,aAAM,gBACJ,qBAACC,wBAAW;YAACC,wBAAU,qBAACX;sBACtB,cAAA,qBAACF;;QAILc,OAAOC,aAAM,CAACC,SAAS,CAAC,mBAAmBC,iBAAiB;QAC5DH,OAAOC,aAAM,CAACC,SAAS,CAAC,0CAA0CC,iBAAiB;QACnFH,OAAOC,aAAM,CAACG,WAAW,CAAC,sBAAsBC,GAAG,CAACF,iBAAiB;QACrEH,OAAOC,aAAM,CAACG,WAAW,CAAC,mBAAmBC,GAAG,CAACF,iBAAiB;IACpE;IAEAZ,GAAG,iDAAiD;QAClDR,eAAeS,eAAe,CAAC;YAC7BC,MAAM;YACNC,QAAQ;YACRC,QAAQd,KAAKe,EAAE;QACjB;QAEAC,IAAAA,aAAM,gBACJ,qBAACC,wBAAW;YAACC,wBAAU,qBAACX;sBACtB,cAAA,qBAACF;;QAILc,OAAOC,aAAM,CAACC,SAAS,CAAC,mBAAmBC,iBAAiB;QAC5DH,OAAOC,aAAM,CAACG,WAAW,CAAC,sBAAsBC,GAAG,CAACF,iBAAiB;QACrEH,OAAOC,aAAM,CAACG,WAAW,CAAC,eAAeC,GAAG,CAACF,iBAAiB;IAChE;IAEAZ,GAAG,6CAA6C;QAC9CR,eAAeS,eAAe,CAAC;YAC7BC,MAAM;gBACJa,MAAM;oBAAEC,IAAI;oBAAWC,MAAM;oBAAaC,OAAO;gBAAmB;gBACpEC,SAAS;YACX;YACAhB,QAAQ;YACRC,QAAQd,KAAKe,EAAE;QACjB;QAEAC,IAAAA,aAAM,gBACJ,qBAACC,wBAAW;YAACC,wBAAU,qBAACX;sBACtB,cAAA,qBAACF;;QAILc,OAAOC,aAAM,CAACC,SAAS,CAAC,sBAAsBC,iBAAiB;QAC/DH,OAAOC,aAAM,CAACG,WAAW,CAAC,mBAAmBC,GAAG,CAACF,iBAAiB;QAClEH,OAAOC,aAAM,CAACG,WAAW,CAAC,eAAeC,GAAG,CAACF,iBAAiB;IAChE;IAEAZ,GAAG,2DAA2D;QAC5DR,eAAeS,eAAe,CAAC;YAC7BC,MAAM;YACNC,QAAQ;YACRC,QAAQd,KAAKe,EAAE;QACjB;QAEAC,IAAAA,aAAM,gBACJ,qBAACC,wBAAW;sBACV,cAAA,qBAACZ;;QAILc,OAAOC,aAAM,CAACC,SAAS,CAAC,mCAAmCC,iBAAiB;QAC5EH,OAAOC,aAAM,CAACG,WAAW,CAAC,sBAAsBC,GAAG,CAACF,iBAAiB;IACvE;AACF"}
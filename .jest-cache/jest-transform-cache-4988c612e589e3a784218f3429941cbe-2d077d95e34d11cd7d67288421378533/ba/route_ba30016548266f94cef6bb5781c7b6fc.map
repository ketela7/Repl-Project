{"version":3,"names":["cov_16xq1qdjhw","actualCoverage","s","POST","request","f","authResult","_apiutils","initDriveService","success","b","response","driveService","body","json","fileId","targetFolderId","namePrefix","items","fileIds","length","map","item","id","isBulkOperation","_server","NextResponse","error","status","results","errors","result","copyFile","push","message","processed","failed","type","operation","undefined","handleApiError"],"sources":["/home/runner/workspace/src/app/api/drive/files/copy/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server'\n\nimport { initDriveService, handleApiError } from '@/lib/api-utils'\n\nexport async function POST(request: NextRequest) {\n  try {\n    const authResult = await initDriveService()\n    if (!authResult.success) {\n      return authResult.response!\n    }\n\n    const driveService = authResult.driveService!\n    const body = await request.json()\n\n    // Handle both single and bulk operations\n    const { fileId, targetFolderId, namePrefix, items } = body\n\n    // Determine operation type based on items array or single fileId\n    const fileIds = items && items.length > 0 ? items.map((item: any) => item.id) : [fileId]\n    const isBulkOperation = items && items.length > 1\n\n    if (!fileIds || fileIds.length === 0) {\n      return NextResponse.json({ error: 'File IDs are required' }, { status: 400 })\n    }\n\n    const results = []\n    const errors = []\n\n    for (const id of fileIds) {\n      try {\n        const result = await driveService.copyFile(id, targetFolderId)\n        results.push({ fileId: id, success: true, result })\n      } catch (error: any) {\n        errors.push({\n          fileId: id,\n          success: false,\n          error: error.message || 'Copy failed',\n        })\n      }\n    }\n\n    const response = {\n      success: errors.length === 0,\n      processed: results.length,\n      failed: errors.length,\n      type: isBulkOperation ? 'bulk' : 'single',\n      operation: 'copy',\n      targetFolderId,\n      namePrefix,\n      results,\n      errors: errors.length > 0 ? errors : undefined,\n    }\n\n    return NextResponse.json(response, {\n      status: errors.length === 0 ? 200 : 207,\n    })\n  } catch (error: any) {\n    return handleApiError(error)\n  }\n}\n"],"mappings":"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","ignoreList":[]}
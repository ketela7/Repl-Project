{"version":3,"names":["cov_16q0g6q9pg","actualCoverage","s","POST","request","f","authResult","_apiutils","initDriveService","success","b","response","driveService","body","json","fileId","items","fileIds","length","map","item","id","isBulkOperation","_server","NextResponse","error","status","results","errors","result","deleteFile","push","message","processed","failed","type","operation","undefined","handleApiError"],"sources":["/home/runner/workspace/src/app/api/drive/files/delete/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server'\n\nimport { initDriveService, handleApiError } from '@/lib/api-utils'\n\nexport async function POST(request: NextRequest) {\n  try {\n    const authResult = await initDriveService()\n    if (!authResult.success) {\n      return authResult.response!\n    }\n\n    const driveService = authResult.driveService!\n    const body = await request.json()\n\n    // Handle both single and bulk operations\n    const { fileId, items } = body\n\n    // Determine operation type based on items array or single fileId\n    const fileIds = items && items.length > 0 ? items.map((item: any) => item.id) : [fileId]\n    const isBulkOperation = items && items.length > 1\n\n    if (!fileIds || fileIds.length === 0) {\n      return NextResponse.json({ error: 'File IDs are required' }, { status: 400 })\n    }\n\n    const results = []\n    const errors = []\n\n    for (const id of fileIds) {\n      try {\n        const result = await driveService.deleteFile(id)\n        results.push({ fileId: id, success: true, result })\n      } catch (error: any) {\n        errors.push({\n          fileId: id,\n          success: false,\n          error: error.message || 'Delete operation failed',\n        })\n      }\n    }\n\n    const response = {\n      success: errors.length === 0,\n      processed: results.length,\n      failed: errors.length,\n      type: isBulkOperation ? 'bulk' : 'single',\n      operation: 'delete',\n      results,\n      errors: errors.length > 0 ? errors : undefined,\n    }\n\n    return NextResponse.json(response, {\n      status: errors.length === 0 ? 200 : 207,\n    })\n  } catch (error: any) {\n    return handleApiError(error)\n  }\n}\n"],"mappings":"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","ignoreList":[]}
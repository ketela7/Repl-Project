{"version":3,"names":["DrivePermissionRequired","error","onRetry","compact","cov_2itofms3of","b","f","connecting","setConnecting","s","_react","useState","handleReconnect","fetch","method","headers","window","location","href","console","handleRetry","_jsxruntime","jsxs","_alert","Alert","className","jsx","_lucidereact","AlertTriangle","AlertDescription","_button","Button","size","variant","onClick","RefreshCw","disabled","Shield","_card","Card","CardHeader","CardTitle","CardDescription","CardContent","message","toString","HardDrive","Fragment"],"sources":["/home/runner/workspace/src/components/drive-permission-required.tsx"],"sourcesContent":["'use client'\n\nimport { useState } from 'react'\nimport { HardDrive, Shield, AlertTriangle, RefreshCw } from 'lucide-react'\n\nimport { Button } from '@/components/ui/button'\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Alert, AlertDescription } from '@/components/ui/alert'\n\ninterface DrivePermissionRequiredProps {\n  error?: any\n  onRetry?: () => void\n  compact?: boolean\n}\n\nexport function DrivePermissionRequired({ error, onRetry, compact = false }: DrivePermissionRequiredProps) {\n  const [connecting, setConnecting] = useState(false)\n\n  const handleReconnect = async () => {\n    setConnecting(true)\n\n    try {\n      // Sign out first, then redirect to login\n      await fetch('/api/auth/signout', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n      })\n\n      // Direct OAuth flow for Google Drive permissions\n      window.location.href = '/api/auth/signin/google?callbackUrl=/dashboard/drive'\n    } catch (error) {\n      console.error('Error during reauth:', error)\n      // Fallback: direct OAuth flow\n      window.location.href = '/api/auth/signin/google?callbackUrl=/dashboard/drive'\n    }\n  }\n\n  const handleRetry = () => {\n    if (onRetry) {\n      onRetry()\n    }\n  }\n\n  if (compact) {\n    return (\n      <Alert className=\"border-orange-200 bg-orange-50\">\n        <AlertTriangle className=\"h-4 w-4\" />\n        <AlertDescription className=\"flex items-center justify-between\">\n          <span>Google Drive access required</span>\n          <div className=\"ml-4 flex gap-2\">\n            {onRetry && (\n              <Button size=\"sm\" variant=\"outline\" onClick={handleRetry}>\n                <RefreshCw className=\"mr-1 h-3 w-3\" />\n                Retry\n              </Button>\n            )}\n            <Button size=\"sm\" onClick={handleReconnect} disabled={connecting}>\n              <Shield className=\"mr-1 h-3 w-3\" />\n              {connecting ? 'Connecting...' : 'Grant Access'}\n            </Button>\n          </div>\n        </AlertDescription>\n      </Alert>\n    )\n  }\n\n  return (\n    <div className=\"flex min-h-[50vh] items-center justify-center\">\n      <Card className=\"mx-auto max-w-md\">\n        <CardHeader className=\"text-center\">\n          <div className=\"mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-full bg-orange-100\">\n            <AlertTriangle className=\"h-8 w-8 text-orange-600\" />\n          </div>\n          <CardTitle className=\"text-xl\">Drive Access Required</CardTitle>\n          <CardDescription>Reconnect to continue managing your Google Drive files</CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          {error && (\n            <Alert className=\"border-red-200 bg-red-50\">\n              <AlertTriangle className=\"h-4 w-4\" />\n              <AlertDescription className=\"text-sm\">{error.message || error.toString()}</AlertDescription>\n            </Alert>\n          )}\n\n          <div className=\"space-y-3\">\n            <div className=\"flex items-center gap-3 text-sm\">\n              <HardDrive className=\"text-muted-foreground h-4 w-4\" />\n              <span>View and manage your Drive files</span>\n            </div>\n            <div className=\"flex items-center gap-3 text-sm\">\n              <Shield className=\"text-muted-foreground h-4 w-4\" />\n              <span>Secure access with OAuth 2.0</span>\n            </div>\n          </div>\n\n          <div className=\"flex gap-2 pt-2\">\n            {onRetry && (\n              <Button variant=\"outline\" onClick={handleRetry} className=\"flex-1\">\n                <RefreshCw className=\"mr-2 h-4 w-4\" />\n                Try Again\n              </Button>\n            )}\n            <Button onClick={handleReconnect} disabled={connecting} className=\"flex-1\">\n              {connecting ? (\n                <>\n                  <Shield className=\"mr-2 h-4 w-4 animate-pulse\" />\n                  Reconnecting...\n                </>\n              ) : (\n                <>\n                  <Shield className=\"mr-2 h-4 w-4\" />\n                  Reconnect Drive\n                </>\n              )}\n            </Button>\n          </div>\n\n          <p className=\"text-muted-foreground text-center text-xs\">\n            You&rsquo;ll be redirected to Google to authorize Drive permissions\n          </p>\n        </CardContent>\n      </Card>\n    </div>\n  )\n}\n"],"mappings":"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","ignoreList":[]}
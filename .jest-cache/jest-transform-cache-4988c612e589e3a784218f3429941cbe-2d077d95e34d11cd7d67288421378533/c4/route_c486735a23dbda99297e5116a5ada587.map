{"version":3,"names":["cov_1gdo2ar3xx","actualCoverage","s","POST","request","f","session","_auth","auth","b","_server","NextResponse","json","error","status","rememberMe","duration","response","success","message","cookieName","process","env","NODE_ENV","currentToken","cookies","get","value","set","httpOnly","sameSite","path","secure","maxAge","console"],"sources":["/home/runner/workspace/src/app/api/auth/session-duration/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server'\nimport { auth } from '@/auth'\n\nexport async function POST(request: NextRequest) {\n  try {\n    const session = await auth()\n\n    if (!session) {\n      return NextResponse.json({ error: 'Not authenticated' }, { status: 401 })\n    }\n\n    const { rememberMe } = await request.json()\n\n    // Calculate cookie duration based on remember me preference\n    const duration = rememberMe ? 30 * 24 * 60 * 60 : 24 * 60 * 60 // 30 days or 1 day\n\n    // Create response\n    const response = NextResponse.json({\n      success: true,\n      duration,\n      message: rememberMe ? 'Session extended to 30 days' : 'Session set to 1 day',\n    })\n\n    // Set cookie with new duration\n    const cookieName =\n      process.env.NODE_ENV === 'production' ? '__Secure-next-auth.session-token' : 'next-auth.session-token'\n\n    // Get current session token from request\n    const currentToken = request.cookies.get(cookieName)?.value\n\n    if (currentToken) {\n      // Set new cookie with updated maxAge\n      response.cookies.set(cookieName, currentToken, {\n        httpOnly: true,\n        sameSite: 'lax',\n        path: '/',\n        secure: process.env.NODE_ENV === 'production',\n        maxAge: duration,\n      })\n    }\n\n    return response\n  } catch (error) {\n    console.error('Session duration update error:', error)\n    return NextResponse.json({ error: 'Internal server error' }, { status: 500 })\n  }\n}\n"],"mappings":"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","ignoreList":[]}
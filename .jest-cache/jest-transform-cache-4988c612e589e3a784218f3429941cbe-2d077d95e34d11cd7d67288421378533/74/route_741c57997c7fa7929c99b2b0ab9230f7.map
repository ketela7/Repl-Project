{"version":3,"names":["cov_20n0jyre4s","actualCoverage","s","GET","request","f","session","_auth","auth","user","b","_server","NextResponse","redirect","URL","url","loginUrl","searchParams","set","toString","error"],"sources":["/home/runner/workspace/src/app/api/auth/reauth-drive/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server'\n\nimport { auth } from '@/auth'\n\nexport async function GET(request: NextRequest) {\n  try {\n    const session = await auth()\n\n    if (!session?.user) {\n      return NextResponse.redirect(new URL('/auth/v1/login', request.url))\n    }\n\n    // Simple approach: Sign out current session and redirect to login\n    // This will force a new OAuth flow with consent prompt\n\n    // Sign out and redirect to login with a special parameter\n    const loginUrl = new URL('/auth/v1/login', request.url)\n    loginUrl.searchParams.set('reauth', 'drive')\n    loginUrl.searchParams.set('callbackUrl', '/dashboard/drive')\n\n    // We'll handle the signOut in the client side, just redirect to login for now\n    return NextResponse.redirect(loginUrl.toString())\n  } catch (error) {\n    return NextResponse.redirect(new URL('/auth/v1/login', request.url))\n  }\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAQQ;IAAAA,cAAA,YAAAA,CAAA;MAAA,OAAAC,cAAA;IAAA;EAAA;EAAA,OAAAA,cAAA;AAAA;AAAAD,cAAA;AAAAA,cAAA,GAAAE,CAAA;;;;;;+BAJc;;;;;;WAAAC,GAAA;;;;;kCAJoB;;;kCAErB;AAEd,eAAeA,IAAIC,OAAoB;EAAA;EAAAJ,cAAA,GAAAK,CAAA;EAAAL,cAAA,GAAAE,CAAA;EAC5C,IAAI;IACF,MAAMI,OAAA;IAAA;IAAA,CAAAN,cAAA,GAAAE,CAAA,OAAU,MAAM,IAAAK,KAAA,CAAAC,IAAI;IAAA;IAAAR,cAAA,GAAAE,CAAA;IAE1B,IAAI,CAACI,OAAA,EAASG,IAAA,EAAM;MAAA;MAAAT,cAAA,GAAAU,CAAA;MAAAV,cAAA,GAAAE,CAAA;MAClB,OAAOS,OAAA,CAAAC,YAAY,CAACC,QAAQ,CAAC,IAAIC,GAAA,CAAI,kBAAkBV,OAAA,CAAQW,GAAG;IACpE;IAAA;IAAA;MAAAf,cAAA,GAAAU,CAAA;IAAA;IAEA;IACA;IAEA;IACA,MAAMM,QAAA;IAAA;IAAA,CAAAhB,cAAA,GAAAE,CAAA,OAAW,IAAIY,GAAA,CAAI,kBAAkBV,OAAA,CAAQW,GAAG;IAAA;IAAAf,cAAA,GAAAE,CAAA;IACtDc,QAAA,CAASC,YAAY,CAACC,GAAG,CAAC,UAAU;IAAA;IAAAlB,cAAA,GAAAE,CAAA;IACpCc,QAAA,CAASC,YAAY,CAACC,GAAG,CAAC,eAAe;IAEzC;IAAA;IAAAlB,cAAA,GAAAE,CAAA;IACA,OAAOS,OAAA,CAAAC,YAAY,CAACC,QAAQ,CAACG,QAAA,CAASG,QAAQ;EAChD,EAAE,OAAOC,KAAA,EAAO;IAAA;IAAApB,cAAA,GAAAE,CAAA;IACd,OAAOS,OAAA,CAAAC,YAAY,CAACC,QAAQ,CAAC,IAAIC,GAAA,CAAI,kBAAkBV,OAAA,CAAQW,GAAG;EACpE;AACF","ignoreList":[]}